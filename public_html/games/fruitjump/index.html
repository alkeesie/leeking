<!doctype html>
<html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fruit Jump</title>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;900&family=Lora:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/styles.css?v=3">
<style>html,body{margin:0;background:#0b1020}</style>
</head><body>
<nav class="nav nav--on-dark wrapper"><a class="brand" href="/">leek.ing</a><a href="/dashboard.php">Bandit dashboard</a><a href="/about.html">About the experiment</a></nav>
<main class="wrapper">
  <div class="game-shell">
    <canvas id="game"></canvas>
  </div>
</main>
<div class="ad-slot">
  <span class="badge" aria-hidden="true">AD</span>
  <a id="banner-link" href="/click.html" rel="nofollow noopener">
    <img id="banner-fallback" src="/assets/banners/control_static.png" alt="Ad" width="728" height="90">
  </a>
</div>
<footer>Â© leek.ing</footer>
<script>
  (function(){
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const WIDTH = 480;
    const HEIGHT = 640;
    canvas.width = WIDTH;
    canvas.height = HEIGHT;

    const GROUND_Y = HEIGHT - 52;
    const GRAVITY = 0.55;
    const JUMP_VELOCITY = -11.5;
    const PLAYER_SIZE = 28;

    const state = { mode: 'play', score: 0, best: 0, frame: 0 };
    const player = { x: 80, y: GROUND_Y - PLAYER_SIZE, vy: 0, grounded: true };
    let actors = [];

    function reset(){
      state.mode = 'play';
      state.score = 0;
      state.frame = 0;
      actors = [];
      player.y = GROUND_Y - PLAYER_SIZE;
      player.vy = 0;
      player.grounded = true;
    }

    function spawn(type){
      const speed = type === 'fruit' ? 3.0 : 3.4;
      const radius = type === 'fruit' ? 14 : 16;
      const minY = GROUND_Y - 180;
      const maxY = GROUND_Y - 70;
      const y = Math.random() * (maxY - minY) + minY;
      actors.push({ type, x: WIDTH + radius, y, radius, speed });
    }

    function jump(){
      if (state.mode !== 'play') {
        reset();
        return;
      }
      if (!player.grounded) return;
      player.vy = JUMP_VELOCITY;
      player.grounded = false;
    }

    function update(){
      if (state.mode !== 'play') return;
      state.frame++;

      player.vy += GRAVITY;
      player.y += player.vy;
      if (player.y >= GROUND_Y - PLAYER_SIZE) {
        player.y = GROUND_Y - PLAYER_SIZE;
        player.vy = 0;
        player.grounded = true;
      }

      if (state.frame % 90 === 0) spawn('fruit');
      if (state.frame % 210 === 0) spawn('bomb');

      actors.forEach(actor => { actor.x -= actor.speed; });
      actors = actors.filter(actor => actor.x + actor.radius > -10);

      actors.forEach(actor => {
        const px = player.x + PLAYER_SIZE / 2;
        const py = player.y + PLAYER_SIZE / 2;
        const distance = Math.hypot(actor.x - px, actor.y - py);
        if (distance < actor.radius + PLAYER_SIZE * 0.5) {
          if (actor.type === 'fruit') {
            state.score += 1;
            state.best = Math.max(state.best, state.score);
            actor.collected = true;
          } else {
            state.mode = 'over';
          }
        }
      });

      actors = actors.filter(actor => !actor.collected);
    }

    function drawBackground(){
      ctx.fillStyle = '#0b1020';
      ctx.fillRect(0, 0, WIDTH, HEIGHT);
      ctx.fillStyle = '#141b33';
      ctx.fillRect(0, GROUND_Y, WIDTH, HEIGHT - GROUND_Y);
    }

    function drawPlayer(){
      ctx.fillStyle = '#ffd266';
      ctx.fillRect(player.x, player.y, PLAYER_SIZE, PLAYER_SIZE);
      ctx.fillStyle = '#f3722c';
      ctx.fillRect(player.x + PLAYER_SIZE - 6, player.y + 8, 6, 10);
    }

    function drawActors(){
      actors.forEach(actor => {
        ctx.fillStyle = actor.type === 'fruit' ? '#78dc86' : '#e24646';
        ctx.beginPath();
        ctx.arc(actor.x, actor.y, actor.radius, 0, Math.PI * 2);
        ctx.fill();
      });
    }

    function drawHUD(){
      ctx.fillStyle = '#ffffff';
      ctx.font = '32px "Lato", sans-serif';
      ctx.fillText(state.score.toString(), 16, 42);
      ctx.font = '16px "Lato", sans-serif';
      ctx.fillText(`Best: ${state.best}`, 16, 64);
    }

    function drawGameOver(){
      if (state.mode !== 'over') return;
      ctx.fillStyle = 'rgba(0,0,0,0.55)';
      ctx.fillRect(36, HEIGHT / 2 - 80, WIDTH - 72, 160);
      ctx.fillStyle = '#fff';
      ctx.font = '28px "Lora", serif';
      ctx.textAlign = 'center';
      ctx.fillText('Game over', WIDTH / 2, HEIGHT / 2 - 18);
      ctx.font = '18px "Lato", sans-serif';
      ctx.fillText(`Score: ${state.score}`, WIDTH / 2, HEIGHT / 2 + 12);
      ctx.fillText('Tap or press space to play again', WIDTH / 2, HEIGHT / 2 + 42);
      ctx.textAlign = 'left';
    }

    function loop(){
      update();
      drawBackground();
      drawPlayer();
      drawActors();
      drawHUD();
      drawGameOver();
      requestAnimationFrame(loop);
    }

    function handleKey(e){
      if (e.code === 'Space') {
        e.preventDefault();
        jump();
      }
    }

    canvas.addEventListener('pointerdown', jump);
    window.addEventListener('keydown', handleKey);

    reset();
    loop();
  })();
</script>
<script defer src="/bandit/bandit.js?v=4"></script>
</body></html>
